SELECT DISTINCT carriage->>'name' AS name
FROM public."ivpaccounts",
     LATERAL jsonb_array_elements(
       CASE
         WHEN jsonb_typeof(svccarriages::jsonb) = 'array'
           THEN svccarriages::jsonb
         ELSE '[]'::jsonb
       END
     ) AS carriage
WHERE accounttype = 'Customer'
  AND svccarriages IS NOT NULL
  AND svccarriages != '[]'
  AND carriage->>'name' IS NOT NULL
ORDER BY name;